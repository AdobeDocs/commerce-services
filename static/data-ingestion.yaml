openapi: 3.0.3
info:
  title: Data Ingestion API
  description: Data Ingestion API for Adobe Commerce is responsible for ingesting data from Adobe Commerce into the Adobe Commerce SaaS Platform.
  version: 1.0.0
servers:
  - url: https://commerce.adobe.io/feeds/
    description: Production endpoint

tags:
  - name: products
    description: Product API to manage product data, prices, permissions
  - name: metadata (TODO)
    description: Product Metadata API
  - name: prices (TODO)
    description: Product Prices Feed API
  - name: price-books (TODO)
    description: Price Books Feed API
paths:
  /api/v1/catalog/products/{DATA_SPACE_ID}:
    put:
      tags:
        - products
      summary: Product Feed API
      description: >
        Create a new or replace existing Product entity in given `sku` and `scopes`. If product with same data exists for the same SKU and scopes item will be ignored.
      operationId: ProductsPost
      parameters:
        - $ref: '#/components/parameters/DATA_SPACE_ID'
        - $ref: '#/components/parameters/ContentType'
        - $ref: '#/components/parameters/xApiKey'
        - $ref: '#/components/parameters/xGwSignature'
        - $ref: '#/components/parameters/ContentEncoding'
      responses:
        '202':
          $ref: '#/components/responses/AcceptedResponse'
        '400':
          $ref: '#/components/responses/InvalidItemsResponse'
        '403':
          $ref: '#/components/responses/UnauthorizedResponse'
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/FeedProduct'
            examples:
              SimpleProductWithImages:
                summary: Simple Product with images
                description: Simple Product with images
                value:
                  [
                    {
                      "sku": "red-pants",
                      "scope": {
                        "locale": "en"
                      },
                      "name": "red pants",
                      "slug": "red-pants.html",
                      "status": "ENABLED",
                      "description": "long description about red pants",
                      "shortDescription": "just pants",
                      "roles": [
                        "SEARCH",
                        "CATALOG"
                      ],
                      "metaTags": {
                        "title": " ",
                        "description": "some seo stuff",
                        "keywords": [
                          "pants",
                          "seo",
                          "words"
                        ]
                      },
                      "attributes": [
                        {
                          "code": "cost",
                          "type": "NUMBER",
                          "values": [
                            "10.5"
                          ]
                        },
                        {
                          "code": "states",
                          "type": "ARRAY",
                          "values": [
                            "TX",
                            "CA",
                            "NV"
                          ]
                        }
                      ],
                      "images": [
                        {
                          "url": "https://example.com",
                          "label": "photo of my pants!",
                          "roles": [
                            "PDP",
                            "plp"
                          ]
                        }
                      ],
                      "links": [
                        {
                          "sku": "green-pants",
                          "type": "related"
                        }
                      ],
                      "routes": [
                        {
                          "path": "red-pants"
                        },
                        {
                          "path": "pants/red-pants",
                          "position": 1
                        }
                      ],
                      "options": [
                        {
                          "id": "ABCDEFGHIJKLMNOPQRSTUVWXYZAB",
                          "type": "SWATCH",
                          "values": [
                            {
                              "id": "value-id",
                              "sku": "produc1",
                              "label": "value label",
                              "colorHex": "#000000",
                              "imageUrl": "https://example.com/image.png"
                            }
                          ],
                          "label": "option label",
                          "required": true,
                          "defaultValueId": "no"
                        }
                      ]
                    },
                  ]
    patch:
      tags:
        - products
      summary: Product Feed API
      description: Update Product entity for given `sku` and `scopes`
      operationId: ProductsPut
      parameters:
        - $ref: '#/components/parameters/DATA_SPACE_ID'
        - $ref: '#/components/parameters/ContentType'
        - $ref: '#/components/parameters/xApiKey'
        - $ref: '#/components/parameters/xGwSignature'
        - $ref: '#/components/parameters/ContentEncoding'
      responses:
        '202':
          $ref: '#/components/responses/AcceptedResponse'
        '400':
          $ref: '#/components/responses/InvalidItemsResponse'
        '403':
          $ref: '#/components/responses/UnauthorizedResponse'
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/FeedProduct'
            examples:
              SimpleProductWithImages:
                summary: Update simple Product with images
                description: Update simple Product with images
                value:
                  [
                    {
                      "sku": "red-pants",
                      "scope": {
                        "locale": "en"
                      },
                      "name": "Updated - red pants",
                      "slug": "updated - red-pants.html",
                      "status": "DISABLED",
                      "description": "Updated - long description about red pants",
                      "shortDescription": "Updated - just pants",
                      "roles": [
                        "SEARCH"
                      ],
                      "metaTags": {
                        "title": "Updated - Red",
                        "description": "Updated - some seo stuff",
                        "keywords": [
                          "updated - pants",
                          "updated - edited",
                          "updated - edited"
                        ]
                      },
                      "attributes": [
                        {
                          "code": "cost",
                          "type": "NUMBER",
                          "values": [
                            "11.5"
                          ]
                        },
                        {
                          "code": "states",
                          "type": "ARRAY",
                          "values": [
                            "TX",
                            "CA",
                            "OK",
                            "HI"
                          ]
                        }
                      ],
                      "images": [
                        {
                          "url": "https://example.com",
                          "label": "updated - photo of my pants!",
                          "roles": [
                            "PDP",
                            "plp"
                          ]
                        }
                      ],
                      "links": [
                        {
                          "sku": "gray-pants",
                          "type": "related"
                        }
                      ],
                      "routes": [
                        {
                          "path": "updated-red-pants"
                        },
                        {
                          "path": "updated-pants/red-pants",
                          "position": 1
                        }
                      ],
                      "options": [
                        {
                          "id": "ABCDEFGHIJKLMNOPQRSTUVWXYZAB",
                          "type": "SWATCH",
                          "values": [
                            {
                              "id": "value-id",
                              "sku": "product1",
                              "label": "updeated - value label",
                              "colorHex": "#000000",
                              "imageUrl": "https://example.com/image.png"
                            }
                          ],
                          "label": "updeated - option label",
                          "required": false,
                          "defaultValueId": "no"
                        }
                      ]
                    }
                  ]
    delete:
      tags:
        - products
      summary: Product Feed API
      description: >
        Delete Product entity for given `sku` and `scopes`
      operationId: ProductsDelete
      parameters:
        - $ref: '#/components/parameters/DATA_SPACE_ID'
        - $ref: '#/components/parameters/ContentType'
        - $ref: '#/components/parameters/xApiKey'
        - $ref: '#/components/parameters/xGwSignature'
        - $ref: '#/components/parameters/ContentEncoding'
      responses:
        '202':
          $ref: '#/components/responses/AcceptedResponse'
        '400':
          $ref: '#/components/responses/InvalidItemsResponse'
        '403':
          $ref: '#/components/responses/UnauthorizedResponse'
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/FeedProduct'
            examples:
              SimpleProductWithImages:
                summary: Delete Product
                description: Delete Product
                value:
                  [
                    {
                      "sku": "red-pants",
                      "scopes": {
                        "locale": "English"
                      },
                      "name": "Red pants",
                      "modifiedAt": "2023-06-29 22:30:19"
                    }
                  ]
components:
  responses:
    AcceptedResponse:
      description: All feed items accepted and will be processed asynchronously
      content:
        application/json;charset=UTF-8:
          schema:
            $ref: '#/components/schemas/ProcessFeedResponse'
    InvalidItemsResponse:
      description: One or all received feed items are not valid. Check the "invalidFeedItems" node for details
      content:
        application/json;charset=UTF-8:
          schema:
            $ref: '#/components/schemas/400ProcessFeedResponse'
    UnauthorizedResponse:
      description: Unauthorized request. Verify the "x-api-key" value is correct and ensure the JWT is not expired in "x-gw-signature"
      content:
        application/json;charset=UTF-8:
          schema:
            $ref: '#/components/schemas/403Response'
  parameters:
    DATA_SPACE_ID:
      name: DATA_SPACE_ID
      in: path
      description: Data Space ID. See docs https://experienceleague.adobe.com/docs/commerce-admin/config/services/saas.html
      required: true
      style: simple
      schema:
        type: string
    ContentType:
      name: Content-Type
      in: header
      required: true
      schema:
        type: string
        enum: [application/json]
    xApiKey:
      name: x-api-key
      in: header
      required: true
      schema:
        type: string
      description: Production public API key
    xGwSignature:
      name: x-gw-signature
      in: header
      required: true
      schema:
        type: string
      description: JWT generated for Production public API key
    ContentEncoding:
      name: Content-Encoding
      in: header
      required: false
      schema:
        type: string
        enum: [gzip]
      description: Use this header if the payload is compressed with gzip

  schemas:
    DiscountsFinalPrice:
      title: Final Price
      type: object
      properties:
        code:
          type: object
        price:
          type: number
          format: float
    DiscountsPercentage:
      title: Discount
      type: object
      properties:
        code:
          type: object
        percentage:
          type: number
          format: float
    FeedBreadcrumb:
      title: FeedBreadcrumb
      type: object
      properties:
        categoryId:
          type: string
          description: Category ID
        categoryLevel:
          type: integer
          description: The category level
          format: int32
        categoryName:
          type: string
          description: The name of the category
        categoryUrlKey:
          type: string
          description: The URL key for the category
        categoryUrlPath:
          type: string
          description: The URL path to the category
    FeedItemFailedValidationResult:
      title: FeedItemFailedValidationResult
      type: object
      properties:
        code:
          type: string
          description: code name of invalid field
        itemIndex:
          type: integer
          format: int32
          description: Reference to the feed line item with invalid payload. Starting from 0
        message:
          type: string
          description: Error description
    FeedProduct:
      title: Catalog Product payload
      type: object
      required:
        - sku
        - scopes
        - name
        - slug
        - status
      properties:
        sku:
          type: string
          description: Product unique identifier
          example: MH01
        scopes:
          type: object
          description: Product scope
          items:
            $ref: '#/components/schemas/ProductScope'
        name:
          type: string
          description: Product name
          example: Kangaroo Hoodie
        slug:
          type: string
          description: The URL key of the product
          example: kangaroo-hoodie.html
        description:
          type: string
          description: A description of the product
          example: A kangaroo hoodie for all seasons
        shortDescription:
          type: string
          description: A short description of the product
          example: A hoodie for all seasons with a kangaroo pocket
        status:
          type: string
          description: Enabled (Product is visible on the storefront) / Disabled (Product is not visible on the storefront)
          example: ENABLED
          enum:
            - ENABLED
            - DISABLED
        roles:
          type: array
          description: >
            Storefront area where the product is visible. Empty list means product should not visible individually
            * `CATALOG`: Product is visible in the PLP (product listing page) and PDP (product detail page)
            * `SEARCH`: Product is visible in the SRP (search result page) and PDP (product detail page)
            * `CATALOG, SEARCH`: Product is visible in the PLP, SRP, and PDP
          example: [CATALOG]
          enum:
            - CATALOG
            - SEARCH
          items:
            type: string
        metaTags:
          type: object
          description: Meta attributes that will be specified in <meta> tags
          items:
            $ref: '#/components/schemas/ProductMetaAttribute'
        attributes:
          type: array
          description: A list of product attributes
          items:
            $ref: '#/components/schemas/ProductAttribute'
        images:
          type: array
          description: A list of product images
          items:
            $ref: '#/components/schemas/ProductImage'
        links:
          type: array
          description: List of linked SKUs
          items:
            $ref: '#/components/schemas/ProductLink'
        routes:
          type: array
          description: List of product routes
          items:
            $ref: '#/components/schemas/ProductRoutes'
        options:
          type: array
          description: Options associated with the product
          items:
            $ref: '#/components/schemas/ProductOption'
        createdAt:
          type: string
          description: Timestamp when the product was created
          example: '2024-06-21 02:15:30'
          format: yyyy-MM-dd HH:mm:ss
        modifiedAt:
          type: string
          description: >
            Timestamp when the product was last modified.
            The new value must be greater than the previous value to accept product update
          example: '2024-09-42 02:15:30'
          format: yyyy-MM-dd HH:mm:ss
    ProductScope:
      title: Product Scope
      type: object
      required:
        - locale
      properties:
        locale:
          type: string
          description: the single value that represents content locale, for example, English.
          example: English
    ProductMetaAttribute:
      title: Meta Attributes
      type: object
      properties:
        title:
          type: string
          description: A meta title
        keywords:
          type: array
          description: A meta keywords
          items:
            type: string
        description:
          type: string
          description: A meta description
    ProductAttribute:
      title: Product Attribute
      type: object
      required:
        - code
        - type
        - values
      properties:
        code:
          type: string
          description: Product Attribute Code
        type:
          enum:
            - BOOLEAN
            - NUMBER
            - STRING
            - ARRAY
            - OBJECT
          description: >
            Type of attribute value that will be applied on rendering pahse. Validation will be applied only on rendereing phase. Wrong values would be silently ignored
            * `BOOLEAN`: Accept single value: "true" or false
            * `Number`: Accept single number,e.g. "85", "0.42", etc.
            * `STRING`: Accept single string,e.g. "Great day, yall!"
            * `STRING`: Accept list of strings ,e.g. ["red", "green", "blue"]
            * `OBJECT`: Accept JSON object `"{"name": "swatch", "color": "red"}"`
        values:
          type: array
          description: A list of value(s) associated to a given type.
          items:
            type: string
    ProductRoutes:
      title: Routes
      type: object
      required:
        - path
      properties:
        path:
          type: string
          description: URL path
        position:
          type: integer
          description: Position of a product in this path, default 0.
          format: int32
    ProductImage:
      title: Product Image
      type: object
      required:
        - url
      properties:
        url:
          type: string
          description: Media resource URL
        label:
          type: string
          description: Media resource label
        roles:
          type: array
          description: >
            roles associated with this image, for example: image for PDP, PLP etc.
          items:
            type: string
    ProductOption:
      title: ProductOption
      type: object
      required:
        - id
        - type
        - values
      properties:
        id:
          type: string
          description: Product Option ID
        label:
          type: string
          description: Option label
        required:
          type: boolean
          description: Whether the option is required for selection
          example: false
        defaultValueId:
          type: string
          description: Pre-selected value for the option
        type:
          type: string
          enum:
            - CONFIGURABLE
            - BUNDLE
            - SWATCH
          description: >
            Option type. Additionally to prefedined types, custom types can be used
            * `CONFIGURABLE`: Configurable product option
            * `BUNDLE`: Bundle product option
            * `SWATCH`: Swatch product option
        values:
          type: array
          description: A list of option values
          items:
            $ref: '#/components/schemas/ProductOptionValue'
    ProductOptionValue:
      title: ProductOptionValue
      type: object
      required:
        - id
        - sku
      properties:
        id:
          type: string
          description: Option value ID. For "CONFIGURABLE" type, must be equal to the "attribute code"
        label:
          type: string
          description: Option value label
        colorHex:
          type: string
          description: A hex representation of the color of the option value
        imageUrl:
          type: string
          description: Image URL of the option value
        sku:
          type: string
          description: Product SKU associated to the option value
    ProductLink:
      title: Links
      required:
        - type
        - sku
      type: object
      properties:
        type:
          type: string
          description: Product link type. Additionally to predefined types, custom types can be used
        sku:
          type: string
          description: SKU
      description: Product association
    ItemFailedValidationResult:
      title: ItemFailedValidationResult
      type: object
      properties:
        code:
          type: string
          description: Code of the validation error
        itemIndex:
          type: integer
          description: Index of the conflicting item in the feed
          format: int32
        message:
          type: string
          description: Message of the validation error for the item
        value:
          type: string
          description: The value supplied to the API
    ProcessFeedResponse:
      title: Response payload
      type: object
      properties:
        feedItemReceivedCount:
          type: integer
          description: Number of valid feed items received and processed
          format: int32
        invalidFeedItems:
          type: array
          description: List of feed items that did not pass the validation. Fix the payload for invalid items before resubmitting the feed
          items:
            $ref: '#/components/schemas/FeedItemFailedValidationResult'
      example:
        {
          "feedItemReceivedCount": 2,
          "invalidFeedItems": [
            {
              "itemIndex": 1,
              "code": "{error code}",
              "message": "{error message}"
            }
          ]
        }
    400ProcessFeedResponse:
      title: Response payload
      type: object
      properties:
        feedItemReceivedCount:
          type: integer
          description: 0 valid feed items
          format: int32
          default: 0
        invalidFeedItems:
          type: array
          description: List of feed items that did not pass the validation. Fix the payload for invalid items before resubmitting the feed
          items:
            $ref: '#/components/schemas/FeedItemFailedValidationResult'
      example:
        {
          "feedItemReceivedCount": 0,
          "invalidFeedItems": [
            {
              "itemIndex": 0,
              "code": "{error code}",
              "message": "{error message}"
            },
            {
              "itemIndex": 1,
              "code": "{error code}",
              "message": "{error message}"
            }
          ]
        }
    403Response:
      title: 403 Forbidden
      type: object
      oneOf:
        - title: 403 Unauthorized - invalid JWT
          type: object
          properties:
            error_code:
              type: string
              description: Error code
            message:
              type: string
              description: Error message
          example:
            {
              "error_code":"403053",
              "message":"JWT is invalid"
            }
        - title: 403 Unauthorized
          type: object
          properties:
            error:
              type: object
              properties:
                code:
                  type: string
                  description: Error code
                message:
                  type: string
                  description: Error message
                details:
                  type: object
                  properties:
                    error_code:
                      type: string
                      description: Error code
          example:
            {
              "error": {
                "code": "Forbidden",
                "message": "Client ID is missing",
                "details": {
                  "error_code": "403000"
                }
              }
            }